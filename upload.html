<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<title>航班数据编辑器（基础版）</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body{margin:0;font-family:system-ui;background:#f4f7fb}
header{background:#006495;color:#fff;padding:14px 18px}
main{max-width:1100px;margin:20px auto;padding:0 16px}
textarea{
  width:100%;
  height:70vh;
  padding:14px;
  border-radius:10px;
  border:1px solid #ccc;
  font-family:ui-monospace,monospace;
  white-space:pre;
}
button{
  margin-top:10px;
  padding:10px 16px;
  border-radius:8px;
  border:none;
  background:#006495;
  color:#fff;
}
</style>
</head>

<body>
<header>✈ 航班数据 TXT 编辑器（基础）</header>

<main>
  <textarea id="editor"></textarea>
  <button onclick="save()">保存到 GitHub</button>
  <div id="status"></div>
</main>

<script>
const API = "https://odd-flower-c9ed.1693076637.workers.dev";
const editor = document.getElementById("editor");
const status = document.getElementById("status");

/* 页面加载即读取 */
window.onload = async () => {
  try {
    const res = await fetch(API);
    editor.value = await res.text(); // ⚠️ 必须是 text()
  } catch (e) {
    alert("无法读取数据");
  }
};

/* 保存 */
async function save() {
  status.textContent = "保存中...";
  const res = await fetch(API, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({
      content: editor.value
    })
  });
  status.textContent = res.ok ? "保存成功" : "保存失败";
}
</script>
</body>
</html>
