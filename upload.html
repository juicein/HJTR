<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<title>航班数据编辑器</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body { margin:0; font-family:system-ui; background:#f4f7fb }
header { background:#006495; color:#fff; padding:14px 20px }
main { max-width:1100px; margin:20px auto; padding:0 16px }
textarea {
  width:100%; height:65vh; padding:14px;
  font-family:ui-monospace,monospace;
  white-space:pre; border-radius:10px;
}
button {
  margin-top:10px; padding:10px 18px;
  background:#006495; color:#fff;
  border:none; border-radius:8px;
}
.status { margin-top:8px; color:#444 }
</style>
</head>

<body>
<header>✈ 航班数据 TXT 编辑器</header>

<main>
  <textarea id="editor">加载中…</textarea>
  <br>
  <input id="pwd" type="password" placeholder="编辑口令">
  <br>
  <button onclick="save()">保存</button>
  <div class="status" id="status"></div>
</main>

<script>
const API = "https://odd-flower-c9ed.1693076637.workers.dev";
const editor = document.getElementById("editor");
const status = document.getElementById("status");

window.onload = async () => {
  try {
    const res = await fetch(API);
    editor.value = await res.text();
    status.textContent = "已加载数据";
  } catch (e) {
    status.textContent = "加载失败：" + e.message;
  }
};

async function save() {
  status.textContent = "保存中…";
  const res = await fetch(API, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({
      content: editor.value,
      password: document.getElementById("pwd").value
    })
  });

  status.textContent = res.ok ? "保存成功" : "保存失败";
}
</script>
</body>
</html>
