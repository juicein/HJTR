<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <title>My Galgame</title>
  <link rel="stylesheet" href="assets/style.css">
</head>
<body class="cover">
  <div class="cover-screen">
    <h1 class="game-title">My Galgame</h1>
    <div id="menu"></div>
  </div>

  <script>
    async function loadMenu() {
      const menuDiv = document.getElementById("menu");

      // 显示上次记录
      const last = localStorage.getItem("lastChapter");
      if (last) {
        const contBtn = document.createElement("button");
        contBtn.innerText = "▶ 继续游戏";
        contBtn.className = "start-btn";
        contBtn.onclick = () => {
          location.href = "game.html?chapter=" + encodeURIComponent(last);
        };
        menuDiv.appendChild(contBtn);
      }

      // 读取章节列表
      const res = await fetch("data/chapters.json");
      const chapters = await res.json();

      chapters.forEach(chapter => {
        const btn = document.createElement("button");
        btn.innerText = chapter.replace(".js","");
        btn.className = "level-btn";
        btn.onclick = () => {
          localStorage.setItem("lastChapter", chapter); // 存档
          location.href = "game.html?chapter=" + encodeURIComponent(chapter);
        };
        menuDiv.appendChild(btn);
      });
    }

    loadMenu();
  </script>
</body>
</html>
